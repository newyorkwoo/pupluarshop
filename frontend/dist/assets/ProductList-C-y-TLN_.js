import{e as R,o as r,c as p,a as t,F as $,r as h,b as g,w as N,g as F,t as B,i as x,v as k,j as C,f as c,d as L,k as b,l as M,h as _,m as j,u as A,n as v,p as D}from"./index-BtfrMQy-.js";import{u as E}from"./productStore-C32GSKVk.js";import{_ as T}from"./BaseBreadcrumb-DsToefPo.js";import{_ as z}from"./ProductGrid-Fa_Fbpof.js";import{L as Z}from"./LoadingSpinner-Bsqd8eRR.js";import{_ as q}from"./Pagination-BJz_pDmH.js";import"./product-Ch8gIIad.js";const G={class:"w-full lg:w-64 shrink-0"},H={class:"sticky top-24"},I={class:"mb-6"},J={class:"space-y-2"},K={class:"mb-6"},O={class:"flex gap-2"},Q={class:"mb-6"},W={__name:"Sidebar",props:{categories:{type:Array,default:()=>[]}},emits:["apply"],setup(f){const o=c({minPrice:null,maxPrice:null,sort:""});function n(){o.value={minPrice:null,maxPrice:null,sort:""}}return(a,e)=>{const u=R("router-link");return r(),p("aside",G,[t("div",H,[e[8]||(e[8]=t("h3",{class:"section-title mb-6"},"篩選",-1)),t("div",I,[e[4]||(e[4]=t("h4",{class:"text-xs font-semibold uppercase tracking-wider mb-3"},"分類",-1)),t("ul",J,[(r(!0),p($,null,h(f.categories,s=>(r(),p("li",{key:s.id},[g(u,{to:`/category/${s.slug}`,class:"text-sm text-brand-charcoal hover:text-brand-black transition-colors"},{default:N(()=>[F(B(s.name),1)]),_:2},1032,["to"])]))),128))])]),t("div",K,[e[5]||(e[5]=t("h4",{class:"text-xs font-semibold uppercase tracking-wider mb-3"},"價格範圍",-1)),t("div",O,[x(t("input",{"onUpdate:modelValue":e[0]||(e[0]=s=>o.value.minPrice=s),type:"number",placeholder:"最低",class:"input-field text-xs w-1/2"},null,512),[[k,o.value.minPrice,void 0,{number:!0}]]),x(t("input",{"onUpdate:modelValue":e[1]||(e[1]=s=>o.value.maxPrice=s),type:"number",placeholder:"最高",class:"input-field text-xs w-1/2"},null,512),[[k,o.value.maxPrice,void 0,{number:!0}]])])]),t("div",Q,[e[7]||(e[7]=t("h4",{class:"text-xs font-semibold uppercase tracking-wider mb-3"},"排序",-1)),x(t("select",{"onUpdate:modelValue":e[2]||(e[2]=s=>o.value.sort=s),class:"input-field text-xs"},[...e[6]||(e[6]=[t("option",{value:""},"預設",-1),t("option",{value:"price_asc"},"價格：低到高",-1),t("option",{value:"price_desc"},"價格：高到低",-1),t("option",{value:"newest"},"最新上架",-1)])],512),[[C,o.value.sort]])]),t("button",{onClick:e[3]||(e[3]=s=>a.$emit("apply",o.value)),class:"btn-primary w-full text-xs"},"套用篩選"),t("button",{onClick:n,class:"btn-secondary w-full text-xs mt-2"},"重設")])])}}},X={class:"space-y-4"},Y={__name:"ProductFilter",emits:["change"],setup(f){const o=c("");return(n,a)=>(r(),p("div",X,[x(t("select",{"onUpdate:modelValue":a[0]||(a[0]=e=>o.value=e),onChange:a[1]||(a[1]=e=>n.$emit("change",{sort:o.value})),class:"input-field text-xs"},[...a[2]||(a[2]=[L('<option value="">排序方式</option><option value="price_asc">價格：低到高</option><option value="price_desc">價格：高到低</option><option value="newest">最新上架</option><option value="name_asc">名稱 A-Z</option>',5)])],544),[[C,o.value]])]))}},ee={class:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8"},te={class:"flex flex-col lg:flex-row gap-8 mt-6"},se={class:"w-full lg:w-64 flex-shrink-0"},oe={class:"flex-1"},ae={class:"flex items-center justify-between mb-6"},le={class:"text-sm text-brand-gray"},ne={key:1,class:"text-center py-20"},ve={__name:"ProductList",setup(f){const o=A();D();const n=E(),a=c(!1),e=c(o.params.category||""),u=c([0,2e5]),s=c("newest"),m=c(1),w=v(()=>n.products),U=v(()=>n.totalElements),P=v(()=>n.totalPages),V=v(()=>n.categories),S=v(()=>{const d=[{label:"首頁",to:"/"}];return e.value?d.push({label:e.value,to:`/category/${e.value}`}):d.push({label:"全部商品"}),d});async function y(){a.value=!0;try{await n.fetchProducts({category:e.value,minPrice:u.value[0],maxPrice:u.value[1],sort:s.value,page:m.value-1,size:24})}finally{a.value=!1}}return b([e,u,s],()=>{m.value=1,y()}),b(m,()=>y()),b(()=>o.params.category,d=>{e.value=d||""}),M(async()=>{await n.fetchCategories(),await y()}),(d,l)=>(r(),p("div",ee,[g(T,{items:S.value},null,8,["items"]),t("div",te,[t("aside",se,[g(W,{categories:V.value,selectedCategory:e.value,priceRange:u.value,sortBy:s.value,"onUpdate:category":l[0]||(l[0]=i=>e.value=i),"onUpdate:priceRange":l[1]||(l[1]=i=>u.value=i),"onUpdate:sortBy":l[2]||(l[2]=i=>s.value=i)},null,8,["categories","selectedCategory","priceRange","sortBy"])]),t("div",oe,[t("div",ae,[t("p",le,B(U.value)+" 件商品",1),g(Y,{sortBy:s.value,"onUpdate:sortBy":l[3]||(l[3]=i=>s.value=i)},null,8,["sortBy"])]),a.value?(r(),_(Z,{key:0})):(r(),p($,{key:1},[w.value.length?(r(),_(z,{key:0,products:w.value},null,8,["products"])):(r(),p("div",ne,[...l[5]||(l[5]=[t("p",{class:"text-brand-gray"},"找不到符合條件的商品",-1)])]))],64)),P.value>1?(r(),_(q,{key:2,currentPage:m.value,totalPages:P.value,"onUpdate:page":l[4]||(l[4]=i=>m.value=i),class:"mt-10"},null,8,["currentPage","totalPages"])):j("",!0)])])]))}};export{ve as default};
