import{u as P}from"./orderStore-BdQSSXVX.js";import{k as D,l as S,c as o,b as f,a as e,h as y,F as b,w as O,r as _,m as v,f as i,e as L,o as a,g as I,t as r,x,C as R,q as A,y as k}from"./index-BtfrMQy-.js";import{_ as V}from"./BaseBreadcrumb-DsToefPo.js";import{L as B}from"./LoadingSpinner-Bsqd8eRR.js";import{_ as T}from"./Pagination-BJz_pDmH.js";const h={PENDING:{label:"待處理",color:"bg-yellow-100 text-yellow-700"},PAID:{label:"已付款",color:"bg-blue-100 text-blue-700"},PROCESSING:{label:"處理中",color:"bg-indigo-100 text-indigo-700"},SHIPPED:{label:"已出貨",color:"bg-purple-100 text-purple-700"},DELIVERED:{label:"已送達",color:"bg-green-100 text-green-700"},CANCELLED:{label:"已取消",color:"bg-red-100 text-red-700"},RETURNED:{label:"已退貨",color:"bg-gray-100 text-gray-600"}},G={class:"max-w-4xl mx-auto px-4 sm:px-6 lg:px-8 py-8"},U={key:0,class:"text-center py-16"},$={key:1,class:"space-y-4"},j={class:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-2 mb-4"},q={class:"text-sm font-medium"},z={class:"text-xs text-brand-gray"},F={class:"space-y-2"},H={class:"flex-1"},M={class:"text-brand-gray text-xs"},J={class:"mt-4 pt-4 border-t border-brand-light flex items-center justify-between"},K={class:"font-medium"},Q=["onClick"],st={__name:"OrderHistory",setup(W){const g=P(),u=i([]),d=i(!0),c=i(1),m=i(1);function w(l){var t;return((t=h[l])==null?void 0:t.label)||l}function E(l){var t;return((t=h[l])==null?void 0:t.color)||"bg-gray-100 text-gray-600"}async function p(){d.value=!0;try{const l=await g.fetchOrders({page:c.value-1});u.value=l.content||[],m.value=l.totalPages||1}finally{d.value=!1}}async function N(l){confirm("確定要取消此訂單嗎？")&&(await g.cancelOrder(l),await p())}return D(c,()=>p()),S(()=>p()),(l,t)=>{const C=L("router-link");return a(),o("div",G,[f(V,{items:[{label:"首頁",to:"/"},{label:"我的帳號",to:"/account"},{label:"訂單紀錄"}],class:"mb-6"}),t[4]||(t[4]=e("h1",{class:"text-2xl font-light tracking-wider mb-8"},"訂單紀錄",-1)),d.value?(a(),y(B,{key:0})):(a(),o(b,{key:1},[u.value.length?(a(),o("div",$,[(a(!0),o(b,null,_(u.value,s=>(a(),o("div",{key:s.id,class:"border border-brand-light p-6"},[e("div",j,[e("div",null,[e("p",q,"訂單 #"+r(s.orderNumber),1),e("p",z,r(x(R)(s.createdAt)),1)]),e("span",{class:A([E(s.status),"text-xs px-3 py-1 rounded-full inline-block"])},r(w(s.status)),3)]),e("div",F,[(a(!0),o(b,null,_(s.items,n=>(a(),o("div",{key:n.id,class:"flex items-center gap-4 text-sm"},[t[3]||(t[3]=e("div",{class:"w-16 h-16 bg-brand-cream flex-shrink-0"},null,-1)),e("div",H,[e("p",null,r(n.productName),1),e("p",M,r(n.size)+" × "+r(n.quantity),1)]),e("p",null,r(x(k)(n.subtotal)),1)]))),128))]),e("div",J,[e("span",K,"合計 "+r(x(k)(s.totalAmount)),1),s.status==="PENDING"?(a(),o("button",{key:0,onClick:n=>N(s.id),class:"text-xs text-red-500 underline"},"取消訂單",8,Q)):v("",!0)])]))),128))])):(a(),o("div",U,[t[2]||(t[2]=e("p",{class:"text-brand-gray mb-4"},"尚無訂單紀錄",-1)),f(C,{to:"/products",class:"btn-primary"},{default:O(()=>[...t[1]||(t[1]=[I("開始購物",-1)])]),_:1})])),m.value>1?(a(),y(T,{key:2,currentPage:c.value,totalPages:m.value,"onUpdate:page":t[0]||(t[0]=s=>c.value=s),class:"mt-8"},null,8,["currentPage","totalPages"])):v("",!0)],64))])}}};export{st as default};
