import{k as T,l as _,c as y,a as t,b as o,w as i,i as V,v as $,j as z,F as A,r as D,h as P,m as F,f as n,o as r,g as c,t as g,q as E,x as O,y as G,B as H,A as I}from"./index-BtfrMQy-.js";import{g as J}from"./admin-sw72sElP.js";import{_ as K}from"./DataTable-D28Fm2fi.js";import{_ as w}from"./BaseButton-zFFbkYxN.js";import{_ as d}from"./BaseInput-CNSxzZWL.js";import{B as Q}from"./BaseModal-DmxaG8ja.js";import{L as R}from"./LoadingSpinner-Bsqd8eRR.js";import{_ as W}from"./Pagination-BJz_pDmH.js";const X={class:"flex items-center justify-between mb-6"},Y={class:"flex gap-4 mb-6"},Z=["value"],h={class:"flex gap-2"},ee=["onClick"],le=["onClick"],te=["onClick"],ae={class:"grid grid-cols-2 gap-4"},se={class:"flex justify-end gap-3"},fe={__name:"ProductManage",setup(oe){const m=n(""),v=n(""),p=n([]),B=n([]),b=n(!0),f=n(1),k=n(1),u=n(!1),C=n(null),x=n(!1),a=I({name:"",brand:"",slug:"",price:0,salePrice:null,description:"",stock:0}),q=[{key:"image",label:""},{key:"name",label:"商品名稱"},{key:"brand",label:"品牌"},{key:"price",label:"價格"},{key:"stock",label:"庫存"},{key:"active",label:"狀態"},{key:"actions",label:"操作"}];async function M(){var s,e;b.value=!0;try{const l=await J({page:f.value-1,search:m.value,category:v.value});p.value=((s=l.data)==null?void 0:s.content)||[],k.value=((e=l.data)==null?void 0:e.totalPages)||1}finally{b.value=!1}}function S(s){C.value=s,Object.assign(a,s),u.value=!0}function j(s){s.active=!s.active}function N(s){confirm("確定刪除？")&&(p.value=p.value.filter(e=>e.id!==s.id))}async function L(){x.value=!0,setTimeout(()=>{x.value=!1,u.value=!1},500)}return T([f,m,v],()=>M()),_(()=>M()),(s,e)=>(r(),y("div",null,[t("div",X,[e[14]||(e[14]=t("h1",{class:"text-xl font-light tracking-wider"},"商品管理",-1)),o(w,{onClick:e[0]||(e[0]=l=>u.value=!0)},{default:i(()=>[...e[13]||(e[13]=[c("新增商品",-1)])]),_:1})]),t("div",Y,[V(t("input",{"onUpdate:modelValue":e[1]||(e[1]=l=>m.value=l),type:"text",placeholder:"搜尋商品名稱或品牌...",class:"input-field flex-1"},null,512),[[$,m.value]]),V(t("select",{"onUpdate:modelValue":e[2]||(e[2]=l=>v.value=l),class:"input-field w-48"},[e[15]||(e[15]=t("option",{value:""},"全部分類",-1)),(r(!0),y(A,null,D(B.value,l=>(r(),y("option",{key:l.id,value:l.id},g(l.name),9,Z))),128))],512),[[z,v.value]])]),b.value?(r(),P(R,{key:0})):(r(),P(K,{key:1,columns:q,rows:p.value},{"cell-image":i(({row:l})=>[...e[16]||(e[16]=[t("div",{class:"w-12 h-12 bg-brand-cream"},null,-1)])]),"cell-price":i(({value:l})=>[c(g(O(G)(l)),1)]),"cell-active":i(({value:l})=>[t("span",{class:E([l?"text-green-600":"text-red-500","text-xs"])},g(l?"上架中":"已下架"),3)]),"cell-actions":i(({row:l})=>[t("div",h,[t("button",{onClick:U=>S(l),class:"text-xs underline"},"編輯",8,ee),t("button",{onClick:U=>j(l),class:"text-xs underline"},g(l.active?"下架":"上架"),9,le),t("button",{onClick:U=>N(l),class:"text-xs underline text-red-500"},"刪除",8,te)])]),_:1},8,["rows"])),k.value>1?(r(),P(W,{key:2,currentPage:f.value,totalPages:k.value,"onUpdate:page":e[3]||(e[3]=l=>f.value=l),class:"mt-6"},null,8,["currentPage","totalPages"])):F("",!0),o(Q,{show:u.value,onClose:e[12]||(e[12]=l=>u.value=!1),title:C.value?"編輯商品":"新增商品"},{default:i(()=>[t("form",{onSubmit:H(L,["prevent"]),class:"space-y-4"},[o(d,{label:"商品名稱",modelValue:a.name,"onUpdate:modelValue":e[4]||(e[4]=l=>a.name=l),required:""},null,8,["modelValue"]),o(d,{label:"品牌",modelValue:a.brand,"onUpdate:modelValue":e[5]||(e[5]=l=>a.brand=l),required:""},null,8,["modelValue"]),o(d,{label:"Slug",modelValue:a.slug,"onUpdate:modelValue":e[6]||(e[6]=l=>a.slug=l),required:""},null,8,["modelValue"]),t("div",ae,[o(d,{label:"價格",type:"number",modelValue:a.price,"onUpdate:modelValue":e[7]||(e[7]=l=>a.price=l),modelModifiers:{number:!0},required:""},null,8,["modelValue"]),o(d,{label:"特價",type:"number",modelValue:a.salePrice,"onUpdate:modelValue":e[8]||(e[8]=l=>a.salePrice=l),modelModifiers:{number:!0}},null,8,["modelValue"])]),t("div",null,[e[17]||(e[17]=t("label",{class:"block text-xs uppercase tracking-wider text-brand-charcoal mb-1"},"描述",-1)),V(t("textarea",{"onUpdate:modelValue":e[9]||(e[9]=l=>a.description=l),rows:"4",class:"input-field w-full resize-none"},null,512),[[$,a.description]])]),o(d,{label:"庫存",type:"number",modelValue:a.stock,"onUpdate:modelValue":e[10]||(e[10]=l=>a.stock=l),modelModifiers:{number:!0}},null,8,["modelValue"]),t("div",se,[o(w,{variant:"secondary",onClick:e[11]||(e[11]=l=>u.value=!1)},{default:i(()=>[...e[18]||(e[18]=[c("取消",-1)])]),_:1}),o(w,{type:"submit",loading:x.value},{default:i(()=>[...e[19]||(e[19]=[c("儲存",-1)])]),_:1},8,["loading"])])],32)]),_:1},8,["show","title"])]))}};export{fe as default};
