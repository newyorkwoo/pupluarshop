import{k as C,l as D,c,a as s,i as y,v as N,j as V,h as m,w as f,m as x,f as n,o as l,q as k,t as h,F as A,r as T}from"./index-BtfrMQy-.js";import{p as $,q as J,r as O,s as B}from"./admin-sw72sElP.js";import{_ as L}from"./DataTable-D28Fm2fi.js";import{L as M}from"./LoadingSpinner-Bsqd8eRR.js";import{_ as S}from"./Pagination-BJz_pDmH.js";const j={class:"flex gap-4 mb-6"},G={class:"flex"},I={class:"flex gap-2"},U=["onClick"],q=["onClick"],F=["onClick"],Y={__name:"ReviewManage",setup(z){const i=n(""),r=n(""),g=n([]),d=n(!0),u=n(1),v=n(1),E=[{key:"productName",label:"商品"},{key:"userName",label:"用戶"},{key:"rating",label:"評分"},{key:"content",label:"內容"},{key:"status",label:"狀態"},{key:"createdAt",label:"日期"},{key:"actions",label:"操作"}];function P(t){return{PENDING:"bg-yellow-100 text-yellow-700",APPROVED:"bg-green-100 text-green-700",REJECTED:"bg-red-100 text-red-700"}[t]||""}function w(t){return{PENDING:"待審核",APPROVED:"已核准",REJECTED:"已拒絕"}[t]||t}async function p(){var t,a;d.value=!0;try{const e=await $({page:u.value-1,search:i.value,status:r.value});g.value=((t=e.data)==null?void 0:t.content)||[],v.value=((a=e.data)==null?void 0:a.totalPages)||1}finally{d.value=!1}}async function R(t){await J(t.id),t.status="APPROVED"}async function _(t){await O(t.id),t.status="REJECTED"}async function b(t){confirm("確定刪除此評論？")&&(await B(t.id),await p())}return C([u,i,r],()=>p()),D(()=>p()),(t,a)=>(l(),c("div",null,[a[4]||(a[4]=s("h1",{class:"text-xl font-light tracking-wider mb-6"},"評論管理",-1)),s("div",j,[y(s("input",{"onUpdate:modelValue":a[0]||(a[0]=e=>i.value=e),type:"text",placeholder:"搜尋商品或評論內容...",class:"input-field flex-1"},null,512),[[N,i.value]]),y(s("select",{"onUpdate:modelValue":a[1]||(a[1]=e=>r.value=e),class:"input-field w-40"},[...a[3]||(a[3]=[s("option",{value:""},"全部",-1),s("option",{value:"PENDING"},"待審核",-1),s("option",{value:"APPROVED"},"已核准",-1),s("option",{value:"REJECTED"},"已拒絕",-1)])],512),[[V,r.value]])]),d.value?(l(),m(M,{key:0})):(l(),m(L,{key:1,columns:E,rows:g.value},{"cell-rating":f(({value:e})=>[s("div",G,[(l(),c(A,null,T(5,o=>s("span",{key:o,class:k(["text-sm",o<=e?"text-yellow-500":"text-gray-300"])},"★",2)),64))])]),"cell-status":f(({value:e})=>[s("span",{class:k(["text-xs px-2 py-0.5 rounded-full",P(e)])},h(w(e)),3)]),"cell-actions":f(({row:e})=>[s("div",I,[e.status!=="APPROVED"?(l(),c("button",{key:0,onClick:o=>R(e),class:"text-xs underline text-green-600"},"核准",8,U)):x("",!0),e.status!=="REJECTED"?(l(),c("button",{key:1,onClick:o=>_(e),class:"text-xs underline text-red-500"},"拒絕",8,q)):x("",!0),s("button",{onClick:o=>b(e),class:"text-xs underline text-red-500"},"刪除",8,F)])]),_:1},8,["rows"])),v.value>1?(l(),m(S,{key:2,currentPage:u.value,totalPages:v.value,"onUpdate:page":a[2]||(a[2]=e=>u.value=e),class:"mt-6"},null,8,["currentPage","totalPages"])):x("",!0)]))}};export{Y as default};
