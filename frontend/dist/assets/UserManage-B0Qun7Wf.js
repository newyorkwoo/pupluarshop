import{k as A,l as C,c as f,a,i as x,v as D,j as N,h as p,w as d,m as k,f as s,o,t as v,q as y}from"./index-BtfrMQy-.js";import{c as P}from"./admin-sw72sElP.js";import{_ as w}from"./DataTable-D28Fm2fi.js";import{L as I}from"./LoadingSpinner-Bsqd8eRR.js";import{_ as h}from"./Pagination-BJz_pDmH.js";const B={class:"flex gap-4 mb-6"},S={class:"flex gap-2"},V=["onClick"],$=["onClick"],T={__name:"UserManage",setup(E){const n=s(""),r=s(""),m=s([]),c=s(!0),i=s(1),u=s(1),_=[{key:"name",label:"姓名"},{key:"email",label:"電子郵件"},{key:"role",label:"角色"},{key:"active",label:"狀態"},{key:"createdAt",label:"註冊日期"},{key:"actions",label:"操作"}];async function g(){var l,t;c.value=!0;try{const e=await P({page:i.value-1,search:n.value,role:r.value});m.value=((l=e.data)==null?void 0:l.content)||[],u.value=((t=e.data)==null?void 0:t.totalPages)||1}finally{c.value=!1}}function b(l){l.active=!l.active}function M(l){l.role="ADMIN"}return A([i,n,r],()=>g()),C(()=>g()),(l,t)=>(o(),f("div",null,[t[4]||(t[4]=a("h1",{class:"text-xl font-light tracking-wider mb-6"},"會員管理",-1)),a("div",B,[x(a("input",{"onUpdate:modelValue":t[0]||(t[0]=e=>n.value=e),type:"text",placeholder:"搜尋姓名或信箱...",class:"input-field flex-1"},null,512),[[D,n.value]]),x(a("select",{"onUpdate:modelValue":t[1]||(t[1]=e=>r.value=e),class:"input-field w-40"},[...t[3]||(t[3]=[a("option",{value:""},"全部角色",-1),a("option",{value:"USER"},"一般會員",-1),a("option",{value:"ADMIN"},"管理員",-1)])],512),[[N,r.value]])]),c.value?(o(),p(I,{key:0})):(o(),p(w,{key:1,columns:_,rows:m.value},{"cell-role":d(({value:e})=>[a("span",{class:y(["text-xs px-2 py-0.5 rounded-full",e==="ADMIN"?"bg-purple-100 text-purple-700":"bg-gray-100 text-gray-600"])},v(e==="ADMIN"?"管理員":"會員"),3)]),"cell-active":d(({value:e})=>[a("span",{class:y([e?"text-green-600":"text-red-500","text-xs"])},v(e?"啟用":"停用"),3)]),"cell-actions":d(({row:e})=>[a("div",S,[a("button",{onClick:U=>b(e),class:"text-xs underline"},v(e.active?"停用":"啟用"),9,V),e.role!=="ADMIN"?(o(),f("button",{key:0,onClick:U=>M(e),class:"text-xs underline"},"設為管理員",8,$)):k("",!0)])]),_:1},8,["rows"])),u.value>1?(o(),p(h,{key:2,currentPage:i.value,totalPages:u.value,"onUpdate:page":t[2]||(t[2]=e=>i.value=e),class:"mt-6"},null,8,["currentPage","totalPages"])):k("",!0)]))}};export{T as default};
