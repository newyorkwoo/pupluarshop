import{k as S,l as _,c as p,a as t,i as w,v as L,j as V,d as I,h as f,w as v,m as N,b as j,f as n,o as u,g as O,t as l,x as y,y as b,F as B,r as A}from"./index-BtfrMQy-.js";import{b as M}from"./admin-sw72sElP.js";import{_ as G}from"./DataTable-D28Fm2fi.js";import{L as R}from"./LoadingSpinner-Bsqd8eRR.js";import{_ as $}from"./Pagination-BJz_pDmH.js";import{B as U}from"./BaseModal-DmxaG8ja.js";const F={class:"flex gap-4 mb-6"},H=["value","onChange"],T=["onClick"],h={key:0,class:"space-y-3 text-sm"},q={class:"flex justify-between"},z={class:"flex justify-between"},J={class:"flex justify-between"},K={class:"flex justify-between"},Q={class:"border-t pt-3 mt-3"},W={class:"border-t pt-3 flex justify-between font-semibold"},le={__name:"OrderManage",setup(X){const r=n(""),i=n(""),g=n([]),c=n(!0),d=n(1),m=n(1),s=n(null),E=[{key:"orderNumber",label:"訂單編號"},{key:"customerName",label:"顧客"},{key:"amount",label:"金額"},{key:"status",label:"狀態"},{key:"createdAt",label:"日期"},{key:"actions",label:""}];async function x(){var o,e;c.value=!0;try{const a=await M({page:d.value-1,search:r.value,status:i.value});g.value=((o=a.data)==null?void 0:o.content)||[],m.value=((e=a.data)==null?void 0:e.totalPages)||1}finally{c.value=!1}}function C(o){s.value=o}function P(o,e){o.status=e}return S([d,r,i],()=>x()),_(()=>x()),(o,e)=>(u(),p("div",null,[e[11]||(e[11]=t("h1",{class:"text-xl font-light tracking-wider mb-6"},"訂單管理",-1)),t("div",F,[w(t("input",{"onUpdate:modelValue":e[0]||(e[0]=a=>r.value=a),type:"text",placeholder:"搜尋訂單編號...",class:"input-field flex-1"},null,512),[[L,r.value]]),w(t("select",{"onUpdate:modelValue":e[1]||(e[1]=a=>i.value=a),class:"input-field w-40"},[...e[4]||(e[4]=[I('<option value="">全部狀態</option><option value="PENDING">待處理</option><option value="PROCESSING">處理中</option><option value="SHIPPED">已出貨</option><option value="DELIVERED">已送達</option><option value="CANCELLED">已取消</option>',6)])],512),[[V,i.value]])]),c.value?(u(),f(R,{key:0})):(u(),f(G,{key:1,columns:E,rows:g.value},{"cell-status":v(({value:a,row:k})=>[t("select",{value:a,onChange:D=>P(k,D.target.value),class:"text-xs border rounded px-2 py-1"},[...e[5]||(e[5]=[t("option",{value:"PENDING"},"待處理",-1),t("option",{value:"PROCESSING"},"處理中",-1),t("option",{value:"SHIPPED"},"已出貨",-1),t("option",{value:"DELIVERED"},"已送達",-1),t("option",{value:"CANCELLED"},"已取消",-1)])],40,H)]),"cell-amount":v(({value:a})=>[O(l(y(b)(a)),1)]),"cell-actions":v(({row:a})=>[t("button",{onClick:k=>C(a),class:"text-xs underline"},"查看詳情",8,T)]),_:1},8,["rows"])),m.value>1?(u(),f($,{key:2,currentPage:d.value,totalPages:m.value,"onUpdate:page":e[2]||(e[2]=a=>d.value=a),class:"mt-6"},null,8,["currentPage","totalPages"])):N("",!0),j(U,{show:!!s.value,onClose:e[3]||(e[3]=a=>s.value=null),title:"訂單詳情"},{default:v(()=>[s.value?(u(),p("div",h,[t("div",q,[e[6]||(e[6]=t("span",{class:"text-brand-gray"},"訂單編號",-1)),t("span",null,l(s.value.orderNumber),1)]),t("div",z,[e[7]||(e[7]=t("span",{class:"text-brand-gray"},"顧客",-1)),t("span",null,l(s.value.customerName),1)]),t("div",J,[e[8]||(e[8]=t("span",{class:"text-brand-gray"},"電子郵件",-1)),t("span",null,l(s.value.email),1)]),t("div",K,[e[9]||(e[9]=t("span",{class:"text-brand-gray"},"配送地址",-1)),t("span",null,l(s.value.shippingAddress),1)]),t("div",Q,[(u(!0),p(B,null,A(s.value.items,a=>(u(),p("div",{key:a.id,class:"flex justify-between py-1"},[t("span",null,l(a.productName)+" × "+l(a.quantity),1),t("span",null,l(y(b)(a.subtotal)),1)]))),128))]),t("div",W,[e[10]||(e[10]=t("span",null,"合計",-1)),t("span",null,l(y(b)(s.value.totalAmount)),1)])])):N("",!0)]),_:1},8,["show"])]))}};export{le as default};
